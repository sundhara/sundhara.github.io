<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css">
<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
</head>
<body>

<div data-role="page" id="pageone" ata-theme="b">
  <div data-role="header">
    <a href="#pagetwo" data-rel="dialog">选择书本</a>
    <h1>歌谣识字</h1>
    <a href="#" data-rel="dialog">认字进度(<span id="progress">0</span>)</a>

  </div>

  <div id="ssss" data-role="content">
    <p id="wwww">请先选书</p>
  </div>

  <div id="cccc" style="display:none;">
  	<table style="margin: 0 auto">
	    <tr><td align="center"><p class="text-center"><span id="wordarea" style="font-family:”Microsoft YaHei”,Arial,Helvetica,sans-serif,”宋体”;font-size:180px;"></span></p></td></tr>
	    <tr><td align="center"><a href="#" id="know" data-inline="true" data-role="button">认识</a><a href="#" id="unknow" data-inline="true" data-role="button">不认识</a></td></tr>
    </table>
    <p class="text-left">不熟悉的字(<span id="ucount">0</span>)：<span id="uword">销售</span></p><a href="#" style="display:none;" id="review" data-inline="true" data-role="button">不认识的字再学习一遍</a>
    <p class="text-left">熟悉的字(<span id="rcount">0</span>)：<span id="rword">飞机</span></p>
  </div>
  <div data-role="footer">
  <h1></h1>
  </div>
</div>

<div data-role="page" id="pagetwo" ata-theme="b">
  <div data-role="header">
    <h1>请选择</h1>
  </div>
  <div data-role="content">
    <a id="b1" href="#pageone">第一册</a><br/>
    <a id="b2" href="#pageone">第二册</a><br/>
    <a id="b3" href="#pageone">第三册</a><br/>
    <a id="b4" href="#pageone">第四册</a><br/>
  </div>
</div>

<script>
var words = [];
var uwords = [];
var rwords = [];
var	uindex = 0;
var	rindex = 0;
var	windex = 0;
var	wcount = 0;

$(document).on("pageinit","#pageone",function(){
  $("#know").on("tap",function(){
		knowtheword();
		showstatus();
  });
  $("#unknow").on("tap",function(){
		unknowtheword();
		showstatus();
  });
  $("#review").on("tap",function(){
		init_word($("#uword").html());
  });
});


function knowtheword(){
	if(windex < wcount){
		rwords[rindex++] = words[windex++];
	}
}

function unknowtheword(){
	if(windex < wcount){
		uwords[uindex++] = words[windex++];
	}
}

$(document).on("pageinit","#pagetwo",function(){
  $("#b1").on("tap",function(){
    init_word("大哥二弟中四小手一三我七朋数友八五九六十个找山动家出歌少舞干象才子马为日长金妈土有伞头天下气雨风人云星月生可入亮米贝曲快想太睡晚了安你女明目猴么笑要开香心关什门");
  });
  $("#b2").on("tap",function(){
    init_word("打半电点话里角舌两石直儿是口虫对竹正会苗萝黄帮来卜拔巾多狗毛鸟声树哭上去的乌叫木当无们比同着在古起诗放看回谁蝴高老胡都湖叔不田得地鸭面虾鸡藏轻宝向重外工桥爱给兴");
  });
  $("#b3").on("tap",function(){
    init_word("学父业母本房书借包尺乡鱼村水林禾青从草果圈右成猪先兔左牛边羊闪问夜间空闯好坏情晴到牙呀早圆狐再狸见理蚂办蚁法豆请只合洞拿卖睛千跑元步欢买选洗倒孩说乖把推样又像急");
  });
  $("#b4").on("tap",function(){
    init_word("熊黑爸真白短冷热万方玩具答叭娃走汽车连军花猫吃饭条谢姐朵怕更飞机伸双做立弯故足队萤火处西东身带这那灰拍跟节别慢扫拉渴喝文阳光已经很九他己她午飘吱跳满喜许国王雪园");
  });
});

function showstatus(){
	$("#wordarea").html(words[windex]);
	$("#ucount").html(uindex);
	$("#rcount").html(rindex);
	$("#wcount").html(windex);
	$("#progress").html(windex + "/" + wcount);
	$("#uword").html(uwords);
	$("#rword").html(rwords);	
	if(windex >= wcount && uindex > 0){
		$("#review").show();
	}else{
		$("#review").hide();
	}
}

function init_word(content){
	words = [];
	for(var i = 0; i < content.length; i++){
	if(words.length == 0){
			words.push(content.substring(i, i+1));
		}else{
			var pos = randomNum(0, words.length);
			words.splice(pos, 0, content.substring(i, i+1));
		}
	}
	uwords = [];
	rwords = [];
	uindex = 0;
	rindex = 0;
	windex = 0;
	wcount = words.length;
	showstatus();
}

$(document).on("pageshow","#pageone",function(){
	  if("" == words){
			$("#ssss").show();
			$("#cccc").hide();
	  }else{
			$("#cccc").show();
			$("#ssss").hide();
	  }
  });

function randomNum(minNum,maxNum){
    switch(arguments.length){
        case 1:
            return parseInt(Math.random()*minNum+1,10);
        break;
        case 2:
            return parseInt(Math.random()*(maxNum-minNum+1)+minNum,10);
        break;
            default:
                return 0;
            break;
    }
}
</script>

</body>
</html>

